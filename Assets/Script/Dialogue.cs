using UnityEngine;
using System.Collections;
using TMPro;

public class Dialogue : MonoBehaviour
{
    public GameObject anim, exit;
    public int godMode; public bool godModes;
    public TextMeshProUGUI textComponent;
    public string[] lines;
    public int[] textColor;
    public float textSpeed = 0.05f, fadeTime = 1f;

    private float alphaValue, fadeAwayPerSecond;
    public int index;
    private float remainingFadeTime;
    public AudioClip typeSound;
    private AudioSource audioSource;
    public Branching branch;

    void Start()
    {
        // Inisialisasi audioSource
        audioSource = GetComponent<AudioSource>();
        if (audioSource == null)
        {
            Debug.LogWarning("AudioSource tidak ditemukan pada GameObject ini!");
        }
        index = 0;

        // Inisialisasi teks
        textComponent.text = string.Empty;
        alphaValue = 1f;
        fadeAwayPerSecond = 1f / fadeTime;

        StartDialogue();
    }


    
    void Update()
    {
        if(index == 18)
        {
            anim.SetActive(true);
        }
        else if(index == 22)
        {
            anim.SetActive(false);
        }
        //Debug.Log(index);
        // Lanjutkan ke dialog berikutnya dengan klik mouse
            // Saat sentuhan baru dimulai
            if (Input.GetMouseButtonDown(0)) // Klik kiri mouse
            {
                // Saat klik mouse
                if (branch.IsOptionTrue == false && !exit.activeInHierarchy)
                {
                    if (textComponent.text == lines[index])
                {
                    NewLine();
                    Debug.Log(index);
                }
                else
                {
                    StopAllCoroutines();
                    audioSource.Stop();
                    textComponent.text = lines[index];
                }
                }
            }
        // Validasi index untuk menghindari IndexOutOfRangeException
        if (index < 0 || index >= textColor.Length) return;

        // Pengaturan warna teks berdasarkan textColor[index]
        switch (textColor[index])
        {
            case 1: // Warna putih
                SetHexColor("#F4D5D5");
                break;
            case 2: // Warna merah tua
                SetHexColor("#52263E");
                break;
            case 3://red
                SetHexColor("#AC3232");
                break;
            case 4://green
                SetHexColor("#530000");
                break;
            case 5://another deep red
                SetHexColor("#7A4134");
                break;
            case 6://whites
                SetHexColor("#FFFFFF");
                break;
            case 11: // Fade efek
                if (remainingFadeTime > 0)
                {
                    audioSource.Stop();
                    textComponent.text = lines[index];
                    StopAllCoroutines();
                    alphaValue -= fadeAwayPerSecond * Time.deltaTime;
                    alphaValue = Mathf.Clamp01(alphaValue);
                    textComponent.color = new Color(textComponent.color.r, 
                    textComponent.color.g, textComponent.color.b, alphaValue);
                    remainingFadeTime -= Time.deltaTime;
                }
                break;
        }
    }

    // Memulai dialog
    void StartDialogue()
    {
        index = 0;
        StartCoroutine(TypeLine());
    }

    // Menampilkan teks satu per satu (efek mengetik)
    IEnumerator TypeLine()
    {
        // Memutar audio typing jika tersedia
        if (typeSound != null && audioSource != null)
        {
            audioSource.clip = typeSound;
            audioSource.loop = true;
            audioSource.Play();
        }

        foreach (char c in lines[index].ToCharArray())
        {
            textComponent.text += c;
            yield return new WaitForSeconds(textSpeed);
        }

        // Menghentikan audio typing
        if (audioSource != null)
        {
            audioSource.Stop();
        }
    }

    // Pindah ke baris dialog berikutnya
    public void NewLine()
    {
        if (index < lines.Length - 1)
        {
            index++;
            if(godModes == true)
            {
                index = godMode;
                godModes = false;
            }
            textComponent.text = string.Empty;
            alphaValue = 1f; // Reset alpha
            remainingFadeTime = fadeTime; // Reset fade time
            StartCoroutine(TypeLine());
        }
        else
        {
            Debug.Log("Dialog selesai!");
        }
    }

    // Mengubah warna teks dengan hex color
    public void SetHexColor(string hex)
    {
        if (ColorUtility.TryParseHtmlString(hex, out Color color))
        {
            if (textComponent != null)
            {
                textComponent.color = color;
            }
        }
        else
        {
            Debug.LogWarning("Warna hex tidak valid: " + hex);
        }
    }
}
/*
,,::,,,,,,,,,:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,..:;;:;?;,,,,,,:++*+::+*:,,,,,,,,,;?,:::,,,,,,*%,,,,,,,,,,,,,,,:::::::;;;::;+++*@:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,::,,,,,,,,::,,,,,,,,,,:,,,,,,,,,:,,,,,,,,,:
,,::,,,,,,,,:;:,,,,,,,,,,,,,,,,,,,,,,,,,,..:?S%SSSS**;,,,;%*;,,,::,,,,,,,,,,,+S;,,,,,,,,,:?;,,:::;;;+++++++++;;;;;;;;;*?%%?+,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,:;,,,,,,,,:;:,,,,,,,,:;,,,,,,,,,::,,,,,,,,:
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,..:?%*+;;+++*?%%*::;,,,,,,,,,,,,,,,,,,%??+,,,,,,,:::;+?%?+;;;::,,,,..................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,:;:,,,,,,,,,,,,,,,,,,,,,,,,,,,.,;??*;;+++++;;;;+?S?+;:,,,,,,,,,,,,,,,,?;,**,,::;*??+;::,,........,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,:;:,,,,,,,,:;:,,,,,,,:;:,,,,,,,,;:,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,;??+;;+;+++++++++;;+%%++;:,,,,,,,,,,,,,,,,,;?;+++;:,,....,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,:,,,,.,,,,,:,,,,,,,,,:,,,,.,,,,:,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,,;??+;;+++++;+++++++;+;;*%*::::,,,,,,,,,,:::;*?+;:,...,,,,,,,,,,,,,,,,,,,,,,,,,....................,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,,,,:,,,,,,,,,,:,,,,,,,,,:,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,..;?%?+;++;;++++++++++++++++;+?%;,+*:,:;;+++**++*+:,.,,,,,,,,,,,,,,,,,,,,........,,,::;;+++*******++;:,,....,,,,,,,,,,,,,,,,,,,,,,,,,,,,,:;:,,,,,,,,:;:,,,,,,,:;:,,,,,,,,:
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.:?%*+;;+++++++++++++++++++;;+++*S?:;?%?+;::,,,....,,,,,,,,,,,,,,,,,.....,,:;++*??%%%%%%%%%%SS%%%%%SSSS%%?+;:,...,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,.:*%*;;++++;+*++++++++++++++;++****?#S%?:.....,,,,,,,,,,,,,,,,,,,,,...,:;+?%%SS%%%%????%%%%%%%%%%%??%%%%%%%SS#S%?;:....,,,,,,,,,,,,,,,,,,,,,,,,,,,:;,,,,,,,,:;:,,,,,,,,;:,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,.,+%?+;+++++;+*++++++++++++;+++****???%@*.,,,,,,,,,,,,,,,,,,,,,,,..,,:+?%%%%%%???????%%%%%%%%%%SSS%%%%%%%%%SSSSSSSS##%*:...,,,,,,,,,,,,,,,,,,,,,,,,,::,,,,,,,,,:,,,,,,,,,::,,,,
,,,,,,,,,,,,,,,,,,,,,,,.,+??+;++++++;**+++++++;+++;+++****?????#%;,,,,,,,,,,,,,,,,,,,,,..,;?%%%S%%%%%%%%%???%%%SSSS###############SSSSSS###S%%#@#%+,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,.,;??+;++++++;;*?****++++++++++****?????%%+,.,,,,,,,,,,,,,,,,,,,.,:*S#SS%%SSSSSS%%%%SSSSSSSSSSSSSSSS#################SSSS?##@@S+,..,,,,,,,,,,,,,,,,,,,,,,,,,,:;:,,,,,,,:;:,,,,,,,,;
,,,,,,,,,,,,,,,,,,,.,+%?+;++++++++;+?****+++++++++****????%%?;,.,,,,,,,,,,,,,,,,,,,.,+%SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS##############@@#####SSS%####@%:,..,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,.,+%%+;++++++++;+*?******++++++****????%%*:,.,,,,,,,,,,,,,,,,,,..:*S#SSSSSSSSSS#SSSSSSSSSSSSSSSSSSS%%%%%%%%%%%SSSSSS####@@@@#####SS#@#S%+,.,,,,,,,,,,,,,,,,,,,,,,,,,,,:;:,,,,,,,,;:,,,,
,,,,,,,,,,,,,,..,+%%*;;++++++++;+??******++++*****????%?+,..,,,,,,,,,,,,,,,,,,,.,*S#SSSSSS####SS%%%%%%%%SSSSS%%%%?????**???%%%%%%%SSSSSSS##@@#SSSSSSS##SS#S*,.,,,,,,,,,,,,,,,,,,,,,,,,,,:,,,,,,,,,::,,,,
,,,,,,,,,,,..,;*%%*;;++++++++++;*?******++++****???%%*;,.,,,,,,,,,,,,,,,,,,,,.,+S#SSSS####SS%%%%%%%%%SS%%%%??%%%SSSSSS####SSSS%%%%%%SSSSS%%#@#S#########S%%SS;..,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,..,:*???*+;+++++++++++;*?******+++****???%%*:..,,,,,,,,,,,,,,,,,,,,..;%#SSSS###S%%%%%%%%%%%%%%%%%%%SS##@@@@##SSS%%SS%%%%%%%%%%SS%%%S########@####S%%%#%:.,,,,,,,,,,,,,,,,,,,,,,,,,,,:;;,,,,,,,,;
,,,,,..,:*??****;++++++++++;;;+%*****+++****???%%+,.,,,,,,,,,,,,,,,,,,,,,,.,?#SSSS##S%%%%%%%%%%%%%%%%%%S##@@@@##SS%???%%SSSS%%%%%%%%%%%SSSS%%%#@@@#######SS%??##*,.,,,,,,,,,,,,,,,,,,,,,.,,,,,,,,,,,,,,,
,,,.,:+??*++**+;++++++++++;+++%***********???%%*,.,,,,,,,,,,,,,,,,,,,,,,,.;%SSS###S%?%%%%%%S%%%%%%%%S#@@@@##SS%%%??%SSSSS%%%%%SSS%%%%%%%SSSS%%%#@###SS####SSS%S##S+,,,,,,,,,,,,,,,,,,,,,:,,,,,,,,,::,,,,
,.,;*?*+++*?*+++++++++++;;+++%?*********???%%*:.,,,,,,,,,,,,,,,,,,,,,,,,,+SSS###S??%%%%%%%%%%%%%%%S#@@###SSS%%%%SSS#SSS%%%%SSSSS%%%%SS%%%SSSS%%%#####SSS##S%#SSSS#@?,,,,,,,,,,,,,,,,,,,:;:,,,,,,,,;:,,,,
:+??+++++*?+;++++++++++;++++?%*********??%%*,.,,,,,,,,,,,,,,,,,,,,,,,,.,*SSS###?*?%%%%%%%%%%%%%S#@@###SS%%%%%%S####SS%%%%SSSSS%%%%%%S#%%%%SSSS%%%#####S%S##S%SSSSS#@+.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
?*+;++++?*+;+++++++++++++++*S********???S?:.,,,,,,,,,,,,,,,,,,,,,,,,,.,?SS###%*?%%%%%%%%%%%%%S######S%%%%%%SS####SS%%%%##SSS%%%%%%S%S@S%%%%SSS%%%%@###SS%S###SSSSSS@#,,,,,,,,,,,,,,,,,,,,,,,:;:,,,,,,,,;
;;++++*?*;+++++++++++++++**%%******????S+..,,,,,,,,,,,,,,,,,,,,,,,,,,,%SS##S?*??%%%%%%%%%%%S######S%%%%%SS#####SSS%%%S#SSSS%%%%%%S%%S@#%%%%%S#S%%?S####S%%S##SSSSSSS@*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
;++***%*;++++++++++++++++*%S******????S+.,,,,,,,,,,,,,,,,,,,,,,,,,,,.?####S????%%%%%?%%%%%######S%%%%%S##@###SSS%%%S##SSS%%%%%%SS%%%S##%%%%%%##%%%?####S%%S###SSSSSS##,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
++**??*;++++++++++++++++*?S?****?????S*,,,,,,,,,,,,,,,,,,,,,,,,,,,,.+S###S????%%%%%?%%%%S#####S%???%SS##@@##SSS%%S##S%SS%%%%%%SSS%SSS#@S%%%%?##S%%?S###SS%%S##S%SSSSS@+.,,,,,,,,,,,,,,,:;:,,,,,,,,;;,,,,
+**??+;++++++++++++++*+*?%S****????%S;.,,,,,,,,,,,,,,,,,,,,,,,,,,,.;####S???*%%%%??%%%S######%???%S####@@##SS%%SS##%%S%%%%%%%SSS%%#SS#@S%%%S?S##%%?%###SS%%SS##SSSSSS#S,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.
?*??+;+++++++++;+++***+?%S?**????%S%:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,%@###%??*?%%%??%%%S#####S%??%SS###S#@#SS%%SS##S%SS%%%%%%%##S%%#SSSS@#%%%S?%##S%??#@##S%%%S##S%SS%SS@;.,,,,,,,,,,,,,,,,,,,,::,,,,,,,,:
*??+;+++++++++;++******%%S**????%?+,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,.;@#@@S%?*?%%%???%%#####S%%??%S####?%#SS%%%S###%%S%%%%%??S##S%%#S%SS##@%%%%%?###%??%@##SS%%S##S%%S%%%#?.,,,,,,,,,,,,,,,,,,,:;:,,,,,,,,:
?*+;++++++++++++******?%S??????S*,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,S@@@#%%??%%%???%S#####S%%%%S####%+%#SS%%SS##S%%S%%%%??%S##S%%#S%SSS##@%%%%S?###%%?%####S%%S###S%SS%%%S,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.
+;++++++++++++********SS%????%S;.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.?@@@#S%%%%%%???%S#####S%%SSS##@S+;S#S%%%SS##%%S%%%%%??S###S?%#SS%SSS##@%%%%S?###S%?%S###S%%S###S%%S%%?#;.,,,,,,,,,,,,,,::,,,,,,,,;;,,,,
;++++++++++++********%S%????%?:.,,,,,,,,.......,,,,,,,,,,,,,,,,.+@@@@S%%%%%%???%S#####SSSSSS##S#S+S#S%%SSSSS%SS%?%%??%S###S?S@#SS%SSS##@%%%%S?S##S%*%S###S%%S###S%%S%%?S?.,,,,,,,,,,,,,,,,,,,,,,,,:,,,,,
++++++;;+++*********?S%???%#*:;:,,,,..,,:;;+++:.,,,,,,,,,,,,,,.:#@@@#S%%%%S%%%%S#####SSSSS##%+,;##SS%SSSSS%%S%??%%?%S####S?S?%SS%%SS####%%%%S?S###%?%%###S%%S###S%%SS??%#:,,,,,,,,,,,,,,,,,,,:,,,,,,,,,:
+++++++++***********%S???%@#%?SS,,::;+*****++*S*,,,,,,,,,,,,,,,%@###S%%%%S%%%%S@#####SSS##%+:,:?#SSSSSSSS%SS%%%%%%S#####%?S*:SSS%%SS####%?%?S?%###S??%####%%S###S%%%S%??#+,,,,,,,,,,,,,,,,,,:;:,,,,,,,,;
+++++++************?%%??%S*++;?@???**+++;;;;;;+%?,.,,,,,,,,,,.*@####SSS%SSSS%S#SSSSS####%+:,,;%#SSSSSSSSSSS%SSS%S######?%#+,:SSS%S#S####%?%?S%%###S??%S###S%S###S%%%S%?*#?;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
++++***********+**??????S*;;+;+%S?*+;+++++++++;;?%,.,,,,,,,,.;#######?%##SS####%%?*;;+*;,,,,*##SSSSSSSSSSSSSS######S*%%SS##S*#%S%S#S###@%?%?%%%###S??%S###S%####%%%%%??*S%?,,,,,,,,,,,,,,,,,,,,,,,;;,,,,
******************????%?S+;+;+;;S@@#++++++++++++;?%,,,,,,,,,,S#S###S#%##S%%%#*+*?%S#S%*;,,.+SSSS##SSSSSSSSS######S+;?SS;,:;?S#%SSS#S###@S?%?%%%###S??%S####S####%%%%%????#S,,,,,,,,,,,,,,,,,,..,,,::,,,,
*****************???%%?%S;;+;++;+S@@*+++++++++++;;%?.,,,,,,.*@SS###SSS#S%%%#@+;:,,,:+?S##%+:.,,:;+?%S########@@%+:+SS*,,,,,,:SSSSS#S###@S?%?%%%###S%?%S#########%%%?%????##:.,,,,,,,,,,,,,,,,,,,,,,,,,,,
*************+**???%%??S?;++++++;++S%++++++++++;+;;S+.,,,,.,S#SS##SSS##%%%S@#;;;;;++;;:;?S@#%+:,,..,,:+*%S#@#%+,;%S?;;+;,,,,,+#SSS#S###@S?%?%%%###S%?%S#########%%%?%????#@:.,,,,,,,,,,,,,,,:;:,,,,,,,,;
++*************???S%???@?;+++++++;;+S*+++++;++++;;;+S:.,,,.*@SS###SS%SS%S%S#%;+*::;::;?;,:*##@%,.,,,.....,:;:,;?S?+;+****;,,,:%#SS#####@S?%%%%%##SSS?SSS########%%%??????#@;.,,,,,,,,,,,,,,,,,,,,,,,,,,,
S?*++*+******???%S????S%?;+;+++++;;;?S+++++++++++++;?%,,,.:#S%S###%S%SS%S@%#S*?#;?+.:,:?*,,?@##?+:,,;?*++++++;+*:,,:,,,,:*?;,,;##S#####@S%%%%%S##SSS%SSS########%%%????%?S@;.,,,,,,,,,,,,,,,,,,,,,;:,,,,
#@S*+++***?????%S???%S+*?++++++++;;;+S?+++++++++++++;SS,,.?#%SS###%S%%S%%S#@@@####S*%:,,*:,%#@@###S%%?SS%%%%%%SS%?*?;:,,,,;?+,,+#######@%%%%%%S##SS%%#SS########%%S??%%%%S@;.,,,,,,,,,,,,,,,,.,,,,::,,,,
####?*???%%S%?S%???%S*;?%+++++++;;;;+*S++++++++++++;;*@;.:#S%S####%%#SSSS+?#+:::;+%@@*:,,,?@@?*%S@@%%#?:,,,;?%S@@@@@@#S??+,,**:,+S#####@%%%%%%###SS%S#SSS#######%%S%%%SS%S@;.,,,,,,,,,,,,,,,,,,,,,,,,,,,
SSS#@###SS%??S%*?%S?*+;?S**+++++;;;;*+%?+++++++++++;;;S?.%#%SS##@S%SSSS#@%%%,,,,,,,;%#*,:%@S+,,,,;#%#;.,,,,,+SS?***?S@@@#S%?;++:,;%####@%%%%%%###S%%S#%SS#######%SS%%SSS%S@;.,,,,,,,,,,,,,,,:;:,,,,,,,,,
SSSSS@#???**%%*?S%?**+;?S***+++++++;++*%++++++++++;;;;*#+@S%SS##@%%SS%%S@###S%*+;::,,;%*#@?,,,,,,;S#S,,,,,,:;:,,,,+%#@@@@%?S#S%*;,:*###@%%%%%%#SSS%%##%SS#######%SS%%SS%%S#:.,,,,,,,,,,,,,,,,,,,,,,,,,,,
SS%SS%##?***????????*+;*S****++++++;;++%?+++++++++;;;;+#@@%%SS##@%%S%%%S@S%?+?%S####SS##%+,,,,,,.;SS@?,,,,,,,,,,:%###@@@@@@%+S@%%%*+*#@@%%%%%%#SS%%%##S%SS#@####%SS%SSS%%S#,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SSS%%S%S#???????????+;;*S*****++++;;;;+*%++++++++++;;;;?@#%%SS##@%%S%%S#@@%+,,,::;;;;;;**;,,,,,,,:SS@@?,,,,,,,,.*S*%#@@@@#@@#S@%#@##SS@#?%%%%S#SS%%S@#S%SS#@####%SS%SSS%%S#;.,,,,,,,,,,,,,,,,,,,,,,,,,,,
%SSS%%S?S#???***?*?*++;?S*???*+++++;;;;+%?++++++++++;;;*@#%%S###@%%%%SS#@@#;,:::,,,,,,*S?+:,,,,,,,%S@@*.,,,,,,,.+?+?S#@@%;#@@##S?%??%S@S?%%%%SSS%%%###S%SS#@####%SSSSSS?%S@+.,,,,,,,,,,,,,,,,,,,,,,,,,,,
S%SS%%%%?SS****??**+++;?S*???**+++++;;;;*%+++++++++;;;;?@#%%S###@%%%%SS#@@#;,:::,,,,:%#S?+:,,,,,,,:?S#?:,,,,,,;,:SS??%%SS%#@##@@?+;,,:#%%%%%%SS%%%%####%%%S@###SS#SS#S%?%S#*.,,,,,,,,,,,,,,,,,,,,,,,,,,,
S%%SS%?%%?#%**??*+++++;?S*????*+++++;;;++?*+++++;+;;;;;+S@#%S##@@%?%%SS#@@@;,,,,,,,,**++;:,,,,,,,,,,;*S#%*;,,.:;::?S%????%##S;+@#%*;,:S?%%%%%#%SS%S#S##%%%%@###SS#SSS#%%%S#?.,,,,,,,,,,,,,,,,,,,,,,,,,,,
%%%%S%%?%%?#%*?*+;++++;*S?????*++++++;;*++*++++++;+;;;;;?#####@@@%?%%SS#@@@;,,,,,,,,;+,,,,,,,,,,,,,,,,:;*%SS%*+*:;+++???##S%?;;;:;+;,;S?%%S%%S%#%%##SS#S%%%####S#SS#SS%%%S#?..,,,,,,,,,,,,,,,,,,,,,,,,,,
%%%%%%%??%?%@?*++++;++;*S*?????*++++++;+*++++++++;++;;;;?#?%#@@@@S??%###@@@?,,,,,,,,,*S;,,,,,,,,,,,,,,,,,,:;+?%%SS##S##S%*+;;:,,,,,,,*S?%%S%S%SS%S@SSS##%%?####S#S##SS%%%S#?.,,,,,,,,,,,,,,,,,,,,,,,,,,,
S%%%%%%???%?SS+;+++;+;;*S??????*+++++++;+++++++++++;;;;;?#???S@@@#??%##S@#@@+.,,,,,,,.+S+,,,,,,,,,,,,,,,,,,,,,,,,::;;::::::::::::,,::?S%%SS%S%#S%#@SSSS#S%?%#####S#S#%%%%S#?..,,,,,,,,,,,,,,,,,,,,,,,,,,
S%%%%?%%??%%?#?;+;;++;;*S??????*++++;++;;+++++++++;;;;;+?S?????#@@%?%#@S@#@@#;.,,,,,:?*;:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,:::::::::::::::S%%%S%S%S#%%@#S%SSS#%%?########S%%%%S#?.,,,,,,,,,,,,,,,,,,,,,,,,,,,
SS%%%??%???%?%#+;;++;;;+S???????*++++++;;+++**+++++;;;;+*#?*????S@S*%@@#@#@##@+,,,,,;#@#S*;:,,,,,,,,,,,,,,,,,,,,,,,,::::::::::::::::;S?%%S%SSSS%S@@S%S%%#S%*S#######%%%%S#@*.,,,,,,,,,,,,,,,,,,,,,,,,,,,
S#S%%??%%%??%?#?;+;+;;;+S????????*+++++++;+++***+++;;;;+*S?**???*S@*%@@#######@*,,,,.:S?#S?**;++;;:::::::::::::,,,,,,:::::::::::::::+S?%%%%%@@S%@@@S%%%%SS%?%######S%%%SS#@*.,,,,,,,,,,,,,,,,,,,,,,,,,,,
%S#%%%%SS%%?%?SS;;;++;;;%????????**++++;+;++++***+++;;;+*S%***????@??@@@#@#@###@?,,,,.;%#?+**SS%?***++++++++++*?%S*,,,,:::::::::::;?#%%%%%%#@@%#@@@#%%%%%%%??######%%SSSS#@+.,,,,,,,,,,,,,,,,,,,,,,,,,,,
%%##%SSSSS%%%%%#+;;;;;;;%%????????*+++++;;;+*+***++++;;+*S%*****??#%?#%#@@######@S:,,,.+@;;;+*++++****?%%%S#S%S@#%:,,,,,,,,,,:::;?S?S?%?%%#@@@S@@@@@S%%%%%%?%#####%%SSSSS@@;.,,,,,,,,,,,,,,,,,,,,,,,,,,.
%%%#S%S#SS%%%%%#?;;;;;;;???????????*+++;++;;**+****++;;+*%S*******%#?#??S@####S##@#;,,,,%?+;;;;;;;+*?**++**S?*?*;,,,,,,,,,,,:::*#%+;S%??%S@@@##@@#@@@%%%%???S####SSSSSS#@?+,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
S%%S#SS###S%%%%S%;;;;;+;*???????????+;+++++;+?+****+++;+?%S********@S#?%@@@#######@@*,,,,+????*??*+;;;;;;;:;:,,,,,,,,,,,,,:::+%S*;;*S%*%S##@@#@@###@@S%%%%?%####SS#####%;,.,,,,,,,,,,,,,,,,,,,,,,,,,,.,?
SS%%%#SS###%%%%S#+;+;;+;+?*?????????*++++++;+?*+****++++??S*******+%@#%###@#######@@@?,,,,,,::::,,,,,,,,,,,,,,,,,,,,,,,:;+++%S*;;::%%??%###@@@@#####@#%%SSS####S#####?;,.,,,,,,,,,,,,,,,,,,,,,,,,,,,.,?+
S#S%%%##S##S%SSS@*;;;;+;+?*??????????+;+++++;??+****++++?%S?*******+S@S@SSS@#@#####@@@S:,,,,,,,,,,,,,,,,,,,,,,,,,,:;+++++;;++;:::;+S%?%#@@@@@@####@@@#SS#S#######S?+,..,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,%+,
SS##%%%S####SSSS@?;;+;+;+??****??????*;;++;+;+%+*****+++*%%%*******+*@###S?S#S@@###@@@@S;,,,,,,,,,,,,,,,,,,::;+****++;;;;;;;::;*%#@S%%##@#@@@@##@@@@@#####@#S%?+:,..,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,*%*
%%%S#S%%%####SSS@?;;;+;;;??*****?????*+;+++;;;%*+*****+++%?%********+%@?##%?S#S#####@@@@@S*;,,,,,,,,:;;;+*****++;;;;;;;;;;;::*#@@#@%%###@#@@@@@@@@@@@@@@@@@+,,...,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.::
%%%%S#S%%%SS##SS@?;+;;;;;+*?*****?????+;++++;;*%+*******+%%%?*********#%?S#S?S#SS###@@@##@@@##SSSS##@?+++;;;;;;;;;;;;;;;;:::,%@##@#%##S#@@@@@@@@@@@@@@@####,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,
S%%%%%##S%%%%S##@%++++++*+*?******????+;++++;;+S?********?S??********+%#?*%@#?%#%S##@@@@@@@@@@@@@@###%:;;;;;;;;;;;;;:;+:,,,,,+@@#@S##SS#@@@@@@@@@@###SSS%#*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.;S
#S%%%%?S@@##SSSS##S%%%??++**?*******??*+;+;+++;?S*********S%?********+*#%%#S#@SS#S##@@@@#########@#SS#+;;;;;;;;;;;:;+;:,,,,,,,S@@@##SS#@@@#@@@###SS%%%%%%#:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.;%;
##SS%%??#@@@####@S????*++++*??**********+++;++++S?********?S?*********+?@@S?%S@###S#@@##SSS######%+;:*?:;;;;;;;;::+*:,,,,,,,,,+@@@#####@@######S%??%SSSS#%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.;%:,
####S%??%@@###SS@S++++***++**?***********++++++;?S???******S%**********+%@#??SS#@@##@##SS#@#S%*+;::::;S:;;;;;;::;++,,,,,,,,,:%S@#@####@@@########S#%*****:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.:%:,,
%####%%??#@####S##****+******??************+++;+;S?????****%S?***********###%%SS#@@@@##@@##S:::::::::;S::;;::::++;,,,,,,,,,,%#S#SS@##@@@@@########@%......,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,%;,,,
%?S##S???#@####SS#???*********??************+;++;*S?????***?S?***++**+**+*#%###@#@@@###SSS##:::::;:::;S::::,,;++:,,,,,,,,,:,*##SS##@@@###SSSSSSS#S#@;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,%%,,,
S%?S@S??%#@####SS#%?????******??%?***********+;;+;S%?????***%S?*?%%%%%%%%%#@##@@@@@#SSS%%??*::::::::+%S,,,,,+++:,,,,,,,,,,::,*#S###@@SSSSSS#####SSSS:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,%:,,
S%??##%%#@@##@#SSSS*??????*****??%%?**********+++;*#??????**?#?**?SSSS%%SS%S##@@@#*+;;::,:;*%*:::+%#@@*,,,:*+;,,,,,,,::;++++**%S##@@######SS%S###?;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.+*,,
%%??%@S#@#@##@#SSS#%????????****???%?**********+;+;?S????????%??**+*?%####S%S@#@S;:::,:;+*+:;#%?#@S%#@;,,;*::::;++++++**+;;:::,:?@@@@@S+;::,,:::;%#+.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.:%,,
%??%?@@@#####@#SSSS@S%???????****???%?***********+;;%S??????????*****%S%%S%S@#@%:::,:;++;,,,,:%@#%*#S*,:;%*++++;;::,,,,,,,,,,,:%##@@@@%,,,,,,,,,,,#%.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,S;,
#%%%S@#######@#SSSS#;;*%%%?????***??%%%***********+;+S%???????%?****SS%%S%%##@S:,,:;?+:,,::::,,;?#@#++*++:::,,,,,,,,,,,,,,,,,:%%%S#####:,,,,,,,:::S%.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,S?;
@SS#@##@##S@#@###S%S%,.,:;+*?%%S?**??%S%?**********+;+#??????????***S###S%##@@+,;++:;*+:,:::::::+*?*;:,,,,,,,,,,,,,,,,,,,,,,,?S?%S####@%,,,,,,::::S?.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,S*.
@##@##@##SS@#@##@S%%#+.,....,,;%@#%???%SS?**********++?S??????????*+*@@@#S#@@#:+%+,,,,;*:,:::;*%*:,,,,,,,,,,,,,,,,,,,,,,,,,,:#??%S#SS##@+,,,,,::::#?.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,...,,;%?,
##@@##@##SS@#@@@SSS%SS:.,,,,,,,,;%SS???%SS?*******??**+SS?????????*?@#?;::;;*?+;:,:,:,,:**;+**;:,,,,,,,,,,,,,,,,,,,,,,::::,,*#???%#SSS###;,,,:::::#*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,...,::*%S*?,
##@@#@@#SSS@#@@@*+S%%S%,,,,,,,,,..,;%%???SS%*******??***S%????????SS*:,,,,:++;,,,,,:,,:;?S+;:,,,,,,,,,,,,,,,,,,,:::;+++;::,,%S%%%S##SS####+,,:::::#?.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,..:;*?*:,:#+?,
#@@@#@#SS%#@##@@?.;S%%#?,,,,,,,,,,,.,;%%??%#S?******??***#%?????%%+:,,,,;**;,,::::,:;*?*;,,,,,,,,,,,,,,,,,,,,::*%S%????SS%*;%S@#SSS#SSSS@##%*:::::%#,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,??*;::;;+@%S;
@@#@#@SSS%#@@#@@S,.:SS?#?,.,,,,,,,,,,.,+%%??S#S******??***#%??%%+,,,,,;**;,,,:::::+**;:,,,,,,,,,,,,,,,,,,,:+*?%?*++;;;+**?S#@@S?##S#SSSS##*+*:::::*@,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,S?%S%%%*+;;;;
@#@@@#SSS%@@@#@@#:,.,?S%#%,.,,,,,,,,,,,.,;?%%%##?******??*?#S%?:,,,,;*+:,,:::::;*?+:,,,,,,,,,,,,,,,,,,,;+?##%*;;;;+;+??*+*++%#@%*%S###@%;:,,,,::::;#:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,?#:,,,,......
@#@@@SSS%S@@@##@@;.,,.+S%SS;.,,,,,,,,,,,,.,:*%SS@S*+****??*?#+,,,:+*+:,,,::::+??;,,,,,,,,,,,,,,,,,,,:*%%S#?+;;++**+++*;;;?@S*+?S#S*+*%@#;.,,,,:::::S+.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,*S@@+.,,,,,,,,,
##@@SSSS%S@#@##@@?.,,,.,?S%S*,.,,,,,,,,,,,,..,;?S@@%******?%+::;?%*:,,::::;*?*:,,,,,,,,,,,,,,,,,,:*SS%*?%+;;+*%%?#%++;++;;%@*?*++%#%:,;S@+,,,,:::::??.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,..,*S@##@%,,,,,,...,
#@@#%SSS%###@###@S,,,,,,.;%%%%;..,,,,,,,,,,,,,..,;?##?*++%S;::;?+:,,::::;??+,,,,,,,,,,,,,,,,,.,+%#S+;%%+;;;*%S??*?#*++++;+;?%+?%*;+%#?,:S@+,,,,::::+S,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,*S@######*....,:;*%
@@@%%SS%%@##@@##@@;.,,,,,.,+%SS?:..,,,,,,,,,,,,,...,*S#%%#+::**:,,::::+??;,,,,,,,,,,,,,,,,.,:?S%*::*#S;;;+?%?*???*S*++++++;;%?+*?%+;+S#;,S@;,,,::::;#:.,,,,,,,,,,,,,,,,,,,,,,,,,,.,*S#######@@#;;+?%S###
@@#%SSS%%@##@@#S#@%,,,,,,,,.,*S#S+,,,,,,,,,,,,,,,,,,.,;S@*::?+,,::::*?*:,,,,,,,,,,,,,,..,;*S%*:,;?S%#+;+*????*%??*S*+;;+++++;?%*+*%?+;?#+,S#:,,:::::S+.,,,,,,,,,,,,,,,,,,,,,,,,.,;S@#######@@@@S####SSSS
@@S%SS%?#@##@@@#S#@;.,,,,,,,,.,*S##*,.,,,,,,,,,,,,,,,.;#%:;?;,::::*%*:,,,,,,,,,,,,,.,:+?SS%;,:+%S%?S%;+*++*%?*%???S++++++++++;%?***%%+;+S?;@%,,:::::??.,,,,,,,,,,,,,,,,,,,,,,,.:?#######@@@##SSSSSSSSSSS
@@%SS%%%@####@@#S#@S,,,,,,,,,,..,?S@%,.,,,,,,,,,,,,,.+##:;%;,::;*%+,,,,,,,,,,,..,:+?S#S*;,:+?%%%???#*;*++*?%?+%???%+;++++++++++****+?%++;%*+@+,,::::+S,.,,,,,,,,,,,,,,,,,,,,,,;S#####@@@##SSSSSSSSSSSSSS
@#%SS%?S@####@@@SS#@*.,,,,,,,,,,.,:S@S:.,,,,,,,,,,,.+SS+;?;::;*%+,,,,,,,,,,,:;*?S#S?+;:;*S#%??%????@*;++**?%*+%%?S*;++++++++++;+?***+*?++;S*%#,,::::;S,.,,,,,,,,,,,,,,,,,,,,.;@@##@@@##SSSSSSSSSSSSSSSSS
@SSS%?%@@#####@@#SS##;.,,,,,,,,,,,.;#@S:.,,,,,,,,..*@@%+?:,;*?+,.,,,,:;+*?%%%%%?*++**???%#????%???%#*+++**%?*+?%??;++++++++++++;*%??**%*+;+#+#?,:::::S;.,,,,,,,,,,,,,,,,,,,,.:#@@####SSSSSSSSSSSSSSSSSSS
S%S%??#@@#####@@@#SS##;.,,,,,,,,,,,,%##%,,,,,,,,,,?@@#??::*?;,,:;+*?%?****+***??%%?**++%S???*%????S+;+++**S**+*#S++++*++*****+++;+???**%??;?%*@::::;:%+.,,,,,,,,,,,,,,,,,,,,,.;#@#SSSSSSSSSS##SSSSS#SSSS
%S%%?S@#@######@@#SSS##;.,,,,,,,,,,.*###+.,,,,,.:S@###*:+?+++?????*+*?**???***?S%S@*++?S???**%???S*;+++**?S**++**++;++++*?*?*++++;?????*%@?+#*S*,::;:??.,,,,,,,,,,,,,,,,,,,,,,.:S#SSSSSSSSSS##SSSSS##SSS
%%%?%@@#@#S#####@@#SSS##+,.,,,,,,,,.*###S,,,,,.,S@##@#*%%%%%?**?%SS##%***++++?#*?#%;;?S????*?%??%%;;+++**%%*+++++++;++++*?*?*++++;+S%???*%#**S*%,::;:*?.,,,,,,,,,,,,,,,,,,,,,,,.:##SSSSSSSSS##SSSSS##SSS
%%??#@##@#S#@@####@#SSSS#S+,.,,,,,,.*##S#;.,,,:%@@@@@S#SSSSS######S?*+****+++#S*SS+;*#????**%??%S+;;+++**%?*+++++++;++++*?**?*+;++;*#????*?S*S*S:::::+%,,,,,,,,,,,,,,,,,,,,,,,,,.?#SSSSSSSSS##SSSSS###SS
%%%#@@##@#S#@@#####@#SSS%S#S*:,.....%##S#+.,.+@@@@@@@@@@########S?*+****+++++?%%*;;+S????*+?%??#?;;;+++**S*++++++++;++++*????*+;++;;%#????*?S%%S;::::;%,,,,,,,,,,,,,,,,,,,,,,,,,.:##SSSSSSS###SSSSS###SS
%%#@@@##@#S#@@##SSS#@#SSS%%SS%?+:,,;##SS#;..:#@###@@@@SSSSSSS%?*++***++++++++;;;;;;?S*??***????#*;;++++**S*++++++++;++++*????*++;;;;+##????*?##S+,:::;%:.,,,,,,,,,,,,,,,,,,,,,,,,.*@#SSSSSS####SSSS####S
%#@@@@##@#S#@@###SSS####SS%%%%%SS#S##SSSS:.;#@@@@#SS#@*+++++++++***++++++++++++;;;;%%???***????#*+++++++*%*+++++++++++++*?**?**+++;;;*@S????*%@??,::::%:.,,,,,,,,,,,,,,,,,,,,,,,,.,S#SSSSSS####SSSS#####
##@@@@##@#S#@@@###SSSS####S%%%%??%%%%SSS+.:####@@SSSS@?+*****+++++++++++++;+++++;;+S????+*+*???#*+;+++++?%++++++++++++++*????**;++;;;;?@%????*S*S:::::?+.,,,,,,,,,,,,,,,,,,,,,,,,,.+##SSSSS###@#SSS#####
S?#@@@##@#S#@@@#S##SSSS#####S%%?????%%%SS*#@###@#SSSS@S++++++++++++*+;++++++++;;+;*S???*+*+????#*+++++++??++++++++++++++*???*?*;++++;;;%@????*%##;,:::?*.,,,,,,,,,,,,,,,,,,,,,,,,,,,%##SSSS###@#SSS#####
?*S@@@##@#%#@@@#SS###S%%SS####S%??????%%S@@@###@#SSSS@#*++++;++;+?+*+;+++;;+++;;;;%%???*+*+?S??#*;+++*++%?+++++++++++;++*????%+;++++++;+##????*@@*,:::*?.,,,,,,,,,,,,,,,,,,,,,,,,,,.:##SSSS###@##SSS####
%*%@@@###S%#@@@##SS###S%%SSSS#@#%%?????%%%S###@@#SSSS#@*;;;+;++;;%?+?;+++++++;;;;+S???**++**S??#*;+++*+*S*++++++++++;;++*?????;+++++++;;+#S???*#@?,,::+%,,,,,,,,,,,,,,,,,,,,,,,,,,,,.*##SSS######SSS####
S??@@@###S%#@@@###%S###S%%%SSS##??%S%%%%%%%%#@@@SSSSSS@%;;;;;+;;;+%+?*;++++++;+;;*S???*+++**S%?#*;++++**S++++++++++++;++*??*%*;++++++;++;*#S??*#@?,,::;S,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,S##SS####@##SS####
?S?@@##S#S%#@@@@##SSSS##S%%SS%SSS*;;?SS%%%%%%#@@#SSSSS@#;;;;;;;;;;??+%+;;++++;;;;?S???*+;++%SS?#*++++++*%++++++++++++;+**???%+++++++++;+;;?%S*+#@?,:::;S:.,,,,,,,,,,,,,,,,,,,,,,,,,,,.;##SS####@##SS####
*S%#@#SS#S%#@@@@###%SSS##S%%SS%%SSS*,:%#S%%%%%S@#SSSSS@@*;;;;;;;;;+%+*%;;++;++;;;%S???*+;++?SS?#?++++++?%+++++++++++;++**?*%*;+;++++++;;+;;?%%*@@+,:,::S;.,,,,,,,,,,,,,,,,,,,,,,,,,,,,.*@######@##SS####
*SS#@#%S#S%#@@@@##@S%SSS##S%%SS%%%%S?:S@##S%%%%S@SSSSS@@?;;;;;;;;;;*%;%*;;+;;+;;+%?%???+;+**%SSS?++++++??;++++++++++;++**??%+;++++++++++++;;;*S@@*,,:::%+.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.?#S#####@##SS###
??S#@S%S#S%#@@@@####%SSSS##S%SSSS%%%%S@###@#S%%%##SSSS#@S;;;+;+++;;;%*+%+;;+;;;;+%*%%??*;+++?SSS%++++++%*;++++++++++;++***?%;+++++++++++++++;;*@@S:,:,,?+.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,S#S####@##SS###
**%##%%S#%%#@@@@###@SSSSSS##SSSSSSS%%%#####@@SS%%#SSSS#@#+;;+;;+;+;;+%+*%;;++;;;*%*?S??*+++**SSSS*++++*%*+++++++++++;++***%*;++++++++++++++;;;;?@@;,,,,*?.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.:S#####@###S###
?*?#S%%SS%S@@##@@##@S%SS%SS##SSSSSSS%%%#@###@##S%%#SSS#@@?;;;;++++;;;*%+%*;;++;;*%**%%?*+++**?SS%#%++*?%++++++++++++;++**?%+;+++++++++++++++;;+;*@?,:,,+?.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.:S########S###
**?#S%%SS%S@###@#####%SS%%%S##SSS#SSS%%?#@#@@@###%S#SS#@@%;;;;++++;+;;??+%+;+++;?%**?S?**+++**?SS@@*+*??+++++++++++++++**%?;+++++++++++++++;++;;;*S:,,,;%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.:S@###@######
**?#%%%SS%#@#########%SS%%%%#@#SS##SS%%??#@@#@@S##S#SS#@@#+;;;;;+++;;;;?**%+;+;+#S**+%S?*+++**??%##*+??*;+++++++++++++++*S+;+++++++++++++++;++;;;;*S:,,:S,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,%@######S##
**?#%?%S%%####S######S%S%%%%%#@#S####S%%?%@@##@#S###SS####+;;;;;;;;;;;;+?+??;+;S#?**++S?*++++*???%S*+?*++++++++++++;++++*%+++++++++++++++++++++++;;*S:,:S;.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,?@########
**?#%?%S%S####S######S%%%S%%?S@@######S%%?%@@#@#S####S###@?;;;+;;;;;;++;+?+?*;?@?***++?S*+++;+???%S+*?+;++++++++++++++++%*;++++++++++++++++++++++;;;?%*#@*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,S@#######
**%S%?S%%####SS##S####%%%S%%%?#@@######%%%%S@#@@SS#@#S###@%;;;;;;;;;+;;+;+?+?+S#*++++++S?+++++???S%+*%+++++++++++++;+++*S+;+++++++++++++++++++++++;;;*@S#%.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.:S@######
**SS?%S%S####SS#SS####%%%S%%%?S@@######S%%%%####SSS@#S###@S+;;;+++;;;+;++;+**??@*++++++*S*++++???#?+*?+++++++++++++++++?%;+++++++++++++++++++++++;;;;;?%#%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.:#######
*?S%?%%%##S##SS#SS####%%%S%%%?%#@@@#####%%%%%@@#SSS@#S##@@S++;;+;;;;;+++++;+*?*SS+++++++%%+++*???S*++++++++++++++++++++%*;++++++++++++++++++++++++++;;;?@+,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.+@#####
?S#?%%%S#S###SS#S#####%%SSS%%?%#@##@###@S%%%%#@SSSS@#S###@S*+;;++;;;+++++;+;+*??#?+++++++S*++???%S++++++++++++++++;;+**S+;++++++++++++++++++++++++++;;;;%*,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,?@####
%#%%%%%##S###SS#S#####S%SSS%??%########@#%%%%##%SS#@@#####%+++;;+;;;;;;;;;+;;++%##*+++++;*%+*???S%++++++++++++++++;;+*?%;+++++++++++++++++++++++++++++;;;%*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,%@###
#S%%%%S##S##S%SSS#####SSSS#%???#@@@#@##@#%%%%#S%SS#S%??????**+;;++;;;+;;;;;;;;;+S#*++++;+;?%*???S?+++;++++++++++++;+**S*;+++++++++++++++++++++++++++++;;;;S*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,?@##
S%%%%SSS#S##S%SS######SSSS#%%%?#@@@@@##@#%%%%%%SS#@%????******++;;;;;+;;;;;;;;;;#S+++++++;;%????S*++++++++++++++;;++**%+;++++++++++++++++++++++++;;;;++++;+S+.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,*#@
%%%%SS?S#S#S%%SS######SSSS#%%%%%@@@@@@@@@%%%%%%S#@@????****?***+;;+;;+;;;;;;;;;*@%**++++;+;+%???S++++++++++++++;++++*??;;+++++++++++++++++++++;;;++++++;++;+S;.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.;#
S%%SS??##S#S%%SS######SSSSS%%%SS#@@@@@@@#%%S%%%#@#@%??******?*?++;+;;;;;;;;;;;;S@???*+++;;;+?%??S+++;+++++++;;+++++*??*;+++++++++++++++++++++;++++++++++++;;*#:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.:
@##S??%##SS%%SS#######SSS#S%%%S#S#@@@@@@#%%SSS@@@@@%?***+***?**?+;+;;;;;;;;;;;;S#%??**+++;;+?%?%S+;;+++++++++++++**?*%+;++++++++++++++++++++++++**++++***++;;*S:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.
##@#%?S#S%%%%SS#######SSS#S%%SS#SS#@@@@@S%SS#@@###@#?***++***?+??+;;;+++++;;;;;%#%%??*+++;;*???%%+;+++++++++++++*?*%??;++++++++++++++++++++++*****+*+++**++++;?%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
S#SS###S%%%%%S##S####SSSS#%%%S###SSS@@@#%S#@@@@@###@%++*++****?+%%*;++++;+;;;;;?#?S??**+++;*???%%++++++++;+++++*?*???+;++++++++++++++++++++**********+++*++;++;%?.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
??S#%SS#S%%%%S###@##SSSS##%%SS####SSSSSSS#@@@@@@###@#*+++++***?**%%*;;++++;;;;;*S%%S??**++;*???%%+++++++++++++*??*%%?;+++++++++++++++++++******+*++**+++++++++;;#+.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
???S#S%SS##S%##S#@##SS%S@S%%S#####SS%%%S@###@@#@@###@%++++++***?**%%*;+++;;;;;;*S??%%?**+++*???S%++++++++++++*????S%+;++++++++++++++;++***********+*+++++++++++;*#,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
????@@SS%%S###S#@@#SS%S##%?%S####%%%%SS@@##S#@##@####@*+++;++***%+?%%*;+;;;;;;;+S*%%S?***+++???@%;+++++;+++++*???%S*;+++++++++++++++++***********++**++*+;+++++;;#+.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
???S@#@S%%%%S###@#SSS%##S%?S####S%%%%S#@@@@SS#@#@####@S*+++++***??+%%%*;;+++;;;+S**%%S?***++???#*+++++++++++*????S%++++++++++++++++++******************++++++++;+S:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
???####@S%%%%%#@@SSSSS@##%?S###@%%%%S#@@@@@#S%#@@####@@*+++;++***?*+%%%+;;+;;;;+S?+?%S%***+*??%%++++++++++++*????#*;+++++++++++;+;++*******************+++++++;;S*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
??S######%%?%SSS@#SSS####%?S###S%%%%S#@@@#@@#%%@@#####@%+++++++***%**%?%+;;;;+;;S?**S%S?**+*??%%++++++++++**????%S+;+++++++++++;;+++**************???**++++++;+%*,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
?%#SS###@#%%?%SSS##S#####%%S###%%%%%S@@@@##@@#%%##S###@#*+++++++*+*%+?S?%+;;;;;;S?*+*SSS?***??%%++++++++++**????S?;++++++++++++++++++++++*******??????*++++;;?%;.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
%#SSS#@@@@S%?%SSS%#@#####%?S###%%%%%S@@@@###%S#%%####@@@%+++++;++*+*%+%S?S+;;;;;%%**+?SS%*+*??%%++++++++++++*?%??++++++++++;++++++++++++++*****???????*+++;+%*,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SSSS%#@@@@@%%%SSSS%S@####%?S###%%%%%#@@@@###?S@@%?#@@@###*++++++++*+*%+%S%#?+;;;%%*+++%SS?**?*%%+++;++++*+++*%*++;+++++++++++++++++;;+++++****???????**+;+??:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SSSS%#@@@@@#%SSSSS%%S@#@#%?S#@#%%%%%#@@@@##%%@@@@%%#@@@@@%++++++;++++*?+SS%S#%+;%%**+;+SSS?*?*%%+++;+++++++?%*;;+++++++++++++++++;+++++******???*?S#*++;*%+,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SSSS%#@@@@@#%SS#@S%%?#@@#%?S#@#%%%%%#@@@##S%##@@@@%?#@SS%*+++++++;++++*%#++#?@%;%%**+;+*S%%?**%S++;;+++++?S?+;++++++++++++++++++++++******???????%?*;;+??:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
%SSS%S@@@@@@SS#@#%%??S@@#%?%#@#%%%%%#@@###S####@#S#%?#%+++*++++++;+++++*@*;S%%S;%%**+;;+?S%%?*%#*;;;;;;;+*++;++++++++++++++++++*******??????**+++;;;+?%;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
%SSS%S@@@@@@S#@#%%%??%@@#%?%#@@%%%%%S@#@@######%??%#?%#*+++++++;;++++++;%#%##S*+#%*+++;++?%??*?SS%????**++;;;;;;+++++++++++++******?????*+++;;;;;;;;+#S,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
%SSS%%@@@@@##@#%%%???S@@@S%%S#@S%??%%#@#####@S?????%#?SS+++++++;;++++++++****+;+#?**++;;++?%***+*??%%%S%%%%%?%%+;++++++++*******???**++;;;+++++++;++;;S#:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
%%SS%%@@@@@@@#%%%????S@@@S%%S#@#%????%@#####SS%?????SS%#?++++;++;;;+;;++;;;;;;;+S?*+++;++++??+++++***??%%????%@S+++*?+*??********++;+++++++++++++;;+*%S%:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
%%SS%%S@@@@@#%%%????S###@#%S##@@S%????S@###+,:+?%????#%SS++++++;;+;++;+++++;;;;+S?*+++;+++++*++;;+++**??%S%??S#?+%%?********+++++****?????????*+++;+##+.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
%%SS%%%@@@@#%%?????%######SS###@#%%??%?S@@*.,...:SS%%S#%#*+++++;+;+++++++++;;;;+S**++++++;+++++;;;++++*??SS%?##%?*++**?%%????%%%%%%%%????????%S%+++;+%#,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
%%S#SSSS@@#%%?????S@######SS###@@#S%??%%S#%;,....;?*?#@S#%*++;;;;++;+;+;+;;;;;;*S**+++++++++++++;++++++**?S#S?S#SS#?**??%%%?????%%%%%%%%%%%%%%S##*;+;*%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SSS##S%%@#%%%???%#@@######SS##S#@@@#%%%%S#@@S*;:,,:+??S###SS%*+;;;;+++++;;;;;;;?S**+++;+++++++++++++++;++*?%##SS??#@?????????%%%%??**********?SS%++;+#+.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SSSSSSS##%%%?%%%@@@@#@@###S###SS#@@@#S%%%SS####S%%*::*###%%S#@#S?*++;;;;;;;;;;;*@%?**+;;;;;;++++++++++++++*??%##???S@#?*******+++**???????????%%?++*#%:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
#SSSSS#@S%S%S%%#@@@@#@#SSSS###SS##@@@@#S%%%SS###S%%%*+##@@@S%%%%%SSS%%?**++;;;;*@#SSS%?**+++++++++;;;;;;;;+*???S%???#S+++***???%%%%?????S?**??????*##:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
?S#SS#@S%SSS%%%#@@@##@#SSSS###SSS##@@##@#SSSSS####S*;%#S#@%?????????%%%SSSSS%%%S@%??%%SS#SSS%%%%%??**++++++*???%#???S@S%%%%%%????*****??#S+++++*????##?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
??%S###%%S#S%%%@@@@##@#SSS#@#@SSSS###@#@S::;;;;:;:,;S#SSS#?????????????%%%%SS#SSSSSSS%%???%S*%S#####%?????%%S@@#SSSSSS@%???********++*???#*;;;;+++**?@%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
*????#S%SS#S%?%#S@@#@#SSSS###@SSS########*....,..,*#SSSS?@SS##S#@@#%%%%%?***##??%?******+++**%%?**********???S%???????#?*****+++*+++;+?**%S+;;%#%++;?@*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
*????S%%SS@S%?%@#S#@##SSSS@##@###SSS#@@###+,...,+S#SSS@#SS%??%%##%?????*+++%@?***??????**+*##???????***?????**????????S?*++++***++++;+*??*S*+%%%#+;;;SS,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
**???#%%SS@#%??@@@#####@#@@#@@@#SS%SS#@####%;:*S#SSS%##???%SS%?#S*?????**++%@S????????**++*##????????????******???????S?*+++**+++++++;*??*%?+?SS?+++;+#:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
**???#%%%S#@%??#@###SSSS#@SS#@@###SSS#?%@@@@@#@#SSS#?S#S##S%??*#S??????*++++##???????**++++S@S????????*********???????#%+*++*++++++++;+??*?%+;;;;++++;%?.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
*****SS%%SS##%?%@##S%%%S@#SS##@#SSSSS#%+*%#@@@#%%%###@#S%????**#S???*?***+*+##?????**+*++*+S@@%??**********++++???????#%+**++++++++++;+*?**S+;+++++++;*@:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
*?%SS#@S%%SS##??##SSS%S###S###@@#SSS%SS,..,:?#%%S%S;*@%??????**@%?????*+++*+S#????********+SS#S?******++++++;++*%?????SS+*+++++++++++;+***+%?;+++++++;+#*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
+%@@@@@@#SSSS##S%##SSS#@#######@#SS%S%S+.,.,%S?SS%S:*#??????*+?#??????*+*+*+%#???**********SS%#?**++++++++++++*+%?????%S+++++++++++++;++**+?%;++++++++;%?.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
S#@@@@###@@@@#@@@#@##S@@#S###@##@##S%%%%:.,,S%?SS%S;?S??????*+%S?????******+%#???**********SS?#??+++++++++++++++?%????%#++++++++++++++;+****S+++++++++;*S,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
@@@@@#SS###@@@@@#SSS%S@@#S#@###@@@##S%%S%,.,?S?SSS%?%%?????***S%?????******+?#*?*********++SS*#??+;++++++++;++++*%?????#+;;+++++++++++;++*++%*;+++++++;+#:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
@@@@#S###S%SS@@@#S%:.?@@###@SSS*#@@@#S%?%%:.:S%%SS%S#?????**+*S?????*******+?#*?*****++++;+%S*S%?+;++++++++;+++*+??????#?;++++++++++++;+++++?%;+++++++;;#*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
@@#S##*;S%%%S@@@#?,..+@#SSS@#SS?:*%#@@#S%%%;.:%S###%SS???**++?S?????*******+?S*?**++++++;;+%S*%S?*+;+++++++++++*+*%????S#+++++++++++++;+++++*S+++++++++;%S,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
@##@@%.;S%%%S@@@+.,,,,#@SSS#@#%S%:,:*S@@#S%S?;,;?S#####%?*+**%%????*********?S*?+++++++++;+?S??S?*++++++++;++++*++%?????@?;+++++++++++;;+++++%*;++++++;;+@;.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
@@@@@+.+S%%%S@@*.,,,,.+@S%S#@SSSSS%+,.:+?SSSS#?;,,+#%??%S%%??S????*********+?S**+;++++++;;+?S??S?*+;+++++;+++;++++??????%#+;+++++++++++;+++++??;;++++++;;#*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
@@@@@;.;S%%%S@S,,,,,,,,?#%%S#%*SSS%S%*:...,::::+??##%%%%%?*+*S????*****++++;?#**+;+++++++;+?S??S%*+;+++++++++;++++*?%%???#%;++++++++++++;++++*S+++++++++;S%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
%#@@@;.,SS%%S@%.,,,,,,,,%#%%S#?:+?%SS##%*+;;;;++;;#S%%??***+?S*??***++++;+;;?#**++++++++;;**S%*%%?+;++++++++++;+++*??S???%#+;+++++++++++;+++++S*;++++++;;SS,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,+@@@+..+#%%%#?.,,,,,,,,,*S%%S#%,.,:;;++**+;;:,,.;#????****+%%*?**++++++++;;?#**++;++;++;;+*S%?%S?*+++++++++++;+++*?*%????#?;+++++++++++;+++++?%;+++++++;%S,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,.+#@S,,,?#%%S?,,,,,,,,,,.:?SSS#S;,.......,,..,,.+#????*****%?***+++++++++++?#**+++++++++;+*S%??S?*++++++++++++++++?*?%???%#+++++++++++++;+**+*S++++++++;?#,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,.:?@+..,?#S%S*.,,,,,,,,,.,:*%#@@#?;:::;+;:,,,,,%%???******S??**+++++++++;+?#**+++++++++;+*%S??S%*++++++++++++;+++?**S????S?;+++++++++++++++*+S*;++++++;?#,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,..,.:?*,.,+S#S#*..,,,.,,,,,..,:;+***++;;,,,,,,.;#????******S?***+++++++++;+?#**+++++++++;+*%S?*SS*++++++++++++++++?**%%???%S+++++++++++++;++*+?%;++++++;?#:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
S%;.,.,+*;,.,+%#@%:,,:::,,,,,,,..........,,,,,,,%S???*****+*S?**++++++++++++?S+*++++++++++;+S#??%#*+++++++++++++;++*?*?S????#?;+++++++++++++++**S+++++++;?@:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
@@#;,.,.,++;:.,:+??*+;:,,,,,,,,,,,,,,,,,,,,,,,.:#%??******+*S??*+++++++++;++?S+*+++++++++++;*#???S?+++++++++++++;++*%**%%???%#+++++++++++++;++*+S*;+++++;*@:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
?%##%:.,,.,,,,,....,...,,,,,,,,,,,,,,,,,,,,,,,.*#???*****++?S*?*++++++++++++%S+*++++++++++;;+S%?*S?*++++++++++++++++?**?S????#?;++++++++++++;+++?%;+++++;+@+.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
%?S%%S+,.,,,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SS*?******++?S*?*+++++++++;++S%+*++++++++++++;%S??%%*+++++++++++++;++****S%???%S+;+++++++++++;++**S*++++++;#%.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
S#S#??S?,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.:#???*****+++?%*?*+++++++++;++#%+*++++++++++;+;?@???%*+++++++++++++++++***?S????#*;++++++++++++;+++%%;+++++;?#,.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
++*%#??%%:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.+#??*****+;++%%*?*++++;;+++++*#?+*++++++++++++;*#???%*++;+++++++++++;+++***S%???S?;+;+++++++++++;+**S++++;;;+#;.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
+;+*SS??%S;.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,%S?*****+;;++%%***++++;++++++*#?**++++++++++++;+S???%?++++++++++++++;+++*++?S???%S++++++++++++++;;++%?;;+??+;%?.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
++++*S%???S;.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.:#%?*****+;;++S?***++++++++;++*#?**+++++;+++;++;+S%??S%+++++++++++++++;++++**S%???#*;++++++++++++;;++*S+;%SSS;+S:.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
++++*?#????S;.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.+#?*****++;++*S?**++++++++++++*#***+++++++++++++;%S???S*+++++++;+++++++++*+**?S???%%++++++++++++++++++S?;?%%?;;?*.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
+++++*SS??*?@?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.?S?*****+++++*S??*++++++++;;++%#***++++++++++++++*S???S?++++++++++++++;;+*++**S%???S+++++++++++++++;++?S+;;;;;;+%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
*/
